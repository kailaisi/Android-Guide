## 音视频

#### OpenSL ES库



#### FFmpeg处理流程

配置：./configure --enable-gpl --enable-nonfree --enable-libfdk-aac --enable-libx264 --enable-libx265 --enable-filter=delogo --enable-debug= --disable-optimizations --enable-libspeex --enable-shared --enable-pthreads --enable-version3 --enable-hardcoded-tables --host-cflags= --host-ldflags= --enable-libmp3lame --enable-libtheora --enable-libxvid --enable-libvorbis --prefix=/usr/local/ffmpeg　--enable-libxcb

![image-20200802170717466](http://cdn.qiniu.kailaisii.com/typora/20200802170718-564770.png)

输入文件：具有封装格式的mp4,avi等源文件。

demuxer:去马甲。获取编码之后的数据包。

##### 录屏命令

这里的指令需要在ubuntu上执行，不能在ssh中执行。

```bash
ffmpeg -f x11grab -video_size cif -framerate 25 -i $DISPLAY   /tmp/out.yuv
```

-f：指定使用x11grab 采集数据。（可以通过display来查看）

-i:指定从哪儿采集数据，是文件索引号

-r:指定帧率

##### 播放

```bash
ffplay -s 352x280 -pix_fmt bgr0 out.yuv
```

-s：指定对应的播放屏幕

-picfmt：指定对应的播放格式。这个要和上面录制时候的样式保持一直。

##### 格式转化

将out.yuv转化为out.mp4

```
ffmpeg -i out.yuv -vcodec copy -acodec copy out.mp4
```

vcodec：视频信息转化

acodec：音频信息转化。

##### 

文件转化其实只是脱马甲+穿马甲。不需要进行编码解码工作。